version: "3.9"
services:
  vllm_base:
    build:
      context: ..
      dockerfile: docker/Dockerfile
    environment:
      MODE: base
      HOST: 0.0.0.0
      BASE_PORT: 8000
      BASE_MODEL_ID: ${BASE_MODEL_ID:-google/gemma-3-1b-it}
    ports:
      - "8000:8000"
    # Uncomment if your Docker supports NVIDIA runtime
    # runtime: nvidia
    # environment:
    #   NVIDIA_VISIBLE_DEVICES: all

  vllm_ft:
    build:
      context: ..
      dockerfile: docker/Dockerfile
    environment:
      MODE: ft
      HOST: 0.0.0.0
      FT_PORT: 8001
      BASE_MODEL_ID: ${BASE_MODEL_ID:-google/gemma-3-1b-it}
      ADAPTER_PATH: /adapters
    ports:
      - "8001:8001"
    volumes:
      - ./adapters:/adapters
    # Uncomment if your Docker supports NVIDIA runtime
    # runtime: nvidia
    # environment:
    #   NVIDIA_VISIBLE_DEVICES: all
